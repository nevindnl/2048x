{"version":3,"sources":["webpack:///webpack/bootstrap f5a1d834da0bca727348","webpack:///./lib/index.js","webpack:///./lib/game.js","webpack:///./lib/cell.js","webpack:///./lib/board.js","webpack:///./lib/util.js"],"names":["document","addEventListener","canvas","getElementsByTagName","ctx","getContext","game","start","Game","base","size","minDim","maxDim","highProb","board","dim","Math","min","cellDim","draw","installHandlers","getElementsByClassName","style","width","height","gridCellBorder","gridCellDim","i","pow","div","createElement","appendChild","e","key","tilt","vec","newBoard","COLORS","Cell","n","j","prevI","prevJ","merged","font","textAlign","textBaseline","x","y","fillStyle","fillRect","fillText","JSON","stringify","b","val","Board","grid","push","Array","addRandom","positions","length","pos","floor","random","includes","set","cells","reduce","map","row","dir","newGrid","tiltSlice","transpose","col","slice","newSlice","undefined","Util","arr","el"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap f5a1d834da0bca727348\n **/","import Game from './game.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n\tconst canvas = document.getElementsByTagName('canvas')[0];\n\tconst ctx = canvas.getContext('2d');\n\n\tconst game = new Game(ctx);\n\tgame.start();\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/index.js\n **/","import Board from './board.js';\n\nclass Game{\n\tconstructor(ctx){\n\t\tthis.ctx = ctx;\n\n\t\tthis.base = 2;\n\t\tthis.size = 4;\n\t\tthis.minDim = 100;\n\t\tthis.maxDim = 500;\n\t\tthis.highProb = .9;\n\n\t\tthis.board = new Board({size: this.size, base: this.base, highProb: this.highProb});\n\n\t\tthis.dim = Math.min(this.maxDim, this.size * this.minDim);\n\t\tthis.cellDim = this.dim / this.size;\n\t}\n\n\tstart(){\n\t\tthis.draw();\n\t\tthis.installHandlers();\n\t}\n\n\tdraw(){\n\t\tdocument.getElementsByClassName('grid')[0].style.width = this.dim + 'px';\n\t\tdocument.getElementsByClassName('grid')[0].style.height = this.dim + 'px';\n\t\tdocument.getElementsByTagName('canvas')[0].height = this.dim;\n\t\tdocument.getElementsByTagName('canvas')[0].width = this.dim;\n\n\t\tconst gridCellBorder = 6; //mutable\n\n\t\tconst gridCellDim = this.cellDim - 2 * gridCellBorder + 'px';\n\t\tfor (let i = 0; i < Math.pow(this.size, 2); i++){\n\t\t\tconst div = document.createElement('div');\n\t\t\tdiv.style.width = gridCellDim;\n\t\t\tdiv.style.height = gridCellDim;\n\t\t\tdocument.getElementsByClassName('grid')[0].appendChild(div);\n\t\t}\n\n\t\tthis.board.draw(this.ctx, this.cellDim);\n\t}\n\n\tinstallHandlers(){\n\t\tdocument.addEventListener('keydown', e => {\n\t\t\tswitch(e.key){\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\tcase 'w':\n\t\t\t\tcase 'j':\n\t\t\t\t\tthis.tilt([0, -1]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\tcase 's':\n\t\t\t\tcase 'k':\n\t\t\t\t\tthis.tilt([0, 1]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowLeft':\n\t\t\t\tcase 'a':\n\t\t\t\tcase 'h':\n\t\t\t\t\tthis.tilt([-1, 0]);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowRight':\n\t\t\t\tcase 'd':\n\t\t\t\tcase 'l':\n\t\t\t\t\tthis.tilt([1, 0]);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n\n\ttilt(vec){\n\t\tconst newBoard = this.board.tilt(vec);\n\t}\n}\n\nexport default Game;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/game.js\n **/","const COLORS = {\n\t1: 'red',\n\t2: 'orange',\n\t3: 'green',\n\t4: 'blue',\n\t5: 'purple'\n};\n\nclass Cell{\n\tconstructor(n, i, j){\n\t\tthis.n = n;\n\t\tthis.i = i;\n\t\tthis.j = j;\n\n\t\tthis.prevI = null;\n\t\tthis.prevJ = null;\n\t\tthis.merged = false;\n\t}\n\n\tdraw(ctx, cellDim, base){\n\t\tctx.font = '24pt sans-serif';\n\t\tctx.textAlign = 'center';\n\t\tctx.textBaseline = 'middle';\n\n\t\tconst [x, y] = [this.i * cellDim, this.j * cellDim];\n\n\t\tctx.fillStyle = COLORS[this.n];\n\t\tctx.fillRect(x, y, cellDim, cellDim);\n\n\t\tctx.fillStyle = 'white';\n\t\tctx.fillText(JSON.stringify(Math.pow(this.b, val)), x + cellDim / 2, y + cellDim / 2);\n\t}\n}\n\nexport default Cell;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/cell.js\n **/","import Cell from './cell.js';\nimport Util from './util.js';\n\nclass Board{\n  constructor({base, size, highProb}){\n\t\tthis.base = base;\n\t\tthis.size = size;\n\t\tthis.highProb = highProb;\n\n\t\tthis.grid = [];\n\t\tfor(let i = 0; i < size; i++){\n\t\t\tthis.grid.push(new Array(size));\n\t\t}\n\n\t\tthis.addRandom();\n  }\n\n\taddRandom(){\n\t\tconst positions = [];\n\t\twhile(positions.length < 2){\n\t\t\tconst pos = [Math.floor(Math.random() * this.size), Math.floor(Math.random() * this.size)];\n\t\t\tif (!positions.includes(JSON.stringify(pos))){\n\t\t\t\tconst n = Math.random() < this.highProb ? 1 : 2;\n\t\t\t\tthis.board.set(...pos, new Cell(n, ...pos));\n\n\t\t\t\tpositions.push(JSON.stringify(pos));\n\t\t\t}\n\t\t}\n\t}\n\n\tget(i, j){\n\t\treturn this.grid[i][j];\n\t}\n\n\tset(i, j, val){\n\t\tthis.grid[i][j] = val;\n\t}\n\n\tdraw(ctx, cellDim){\n\t\tconst cells = this.grid.reduce()\n\t}\n\n\n\n\n\n\tcol(j){\n\t\treturn this.grid.map(row => row[j]);\n\t}\n\n\ttilt(dir){\n\t\tlet [x, y] = dir;\n\t\tlet newGrid;\n\n\t\tif (x !== 0){\n\t\t\tnewGrid = this.grid.map((row, i) => {\n\t\t\t\ttiltSlice(row, x);\n\t\t\t});\n\t\t} else {\n\t\t\tnewGrid = Util.transpose(Util.transpose(this.grid.map((col, j) => {\n\t\t\t\ttiltSlice(col, y);\n\t\t\t})));\n\t\t}\n\n\t\tfunction tiltSlice(slice){\n\t\t\tconst newSlice = [];\n\n\t\t\tlet i = 0;\n\t\t\twhile (i < slice.length){\n\t\t\t\tif (slice[i] !== undefined){\n\t\t\t\t\tif(slice[i + 1] !== undefined && slice[i - 1].n === slice[i].n){\n\t\t\t\t\t\tnewSlice.push()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn newSlice;\n\t\t}\n\n\n\t\treturn new Board(this.b, this.size, newGrid);\n\t}\n\n\n}\n\nexport default Board;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/board.js\n **/","const Util = {\n\ttranspose(arr){\n\t\treturn arr.map((row, i) => {\n\t\t\treturn row.map((el, j) => {\n\t\t\t\treturn arr[j][i];\n\t\t\t});\n\t\t});\n\t}\n};\n\nexport default Util;\n\n\n\n/** WEBPACK FOOTER **\n ** ./lib/util.js\n **/"],"sourceRoot":""}